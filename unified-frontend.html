<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrandPro HMSO - Hospital Management Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .module-card { transition: transform 0.3s; }
        .module-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-hospital text-3xl mr-3"></i>
                    <div>
                        <h1 class="text-2xl font-bold">GrandPro HMSO</h1>
                        <p class="text-sm opacity-90">Hospital Management Platform</p>
                    </div>
                </div>
                <nav class="flex space-x-4">
                    <a href="#modules" class="hover:text-purple-200">Modules</a>
                    <a href="#dashboard" class="hover:text-purple-200">Dashboard</a>
                    <a href="#api" class="hover:text-purple-200">API Docs</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- System Status -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">System Status</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <i class="fas fa-server text-green-600 text-2xl mb-2"></i>
                    <p class="text-sm text-gray-600">Backend API</p>
                    <p class="font-semibold text-green-600">Online</p>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <i class="fas fa-database text-green-600 text-2xl mb-2"></i>
                    <p class="text-sm text-gray-600">Database</p>
                    <p class="font-semibold text-green-600">Connected</p>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <i class="fas fa-chart-line text-green-600 text-2xl mb-2"></i>
                    <p class="text-sm text-gray-600">Analytics</p>
                    <p class="font-semibold text-green-600">Active</p>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <i class="fas fa-shield-alt text-green-600 text-2xl mb-2"></i>
                    <p class="text-sm text-gray-600">Security</p>
                    <p class="font-semibold text-green-600">Enabled</p>
                </div>
            </div>
        </div>

        <!-- Modules Grid -->
        <section id="modules" class="mb-8">
            <h2 class="text-2xl font-bold mb-6">Platform Modules</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Digital Sourcing -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-handshake text-purple-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">Digital Sourcing</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Hospital onboarding and partner management</p>
                    <div class="space-y-2">
                        <button onclick="testAPI('/api/onboarding/applications', 'GET')" class="w-full text-left px-3 py-2 bg-purple-50 rounded hover:bg-purple-100">
                            <i class="fas fa-list mr-2"></i>View Applications
                        </button>
                        <button onclick="showApplicationForm()" class="w-full text-left px-3 py-2 bg-purple-50 rounded hover:bg-purple-100">
                            <i class="fas fa-plus mr-2"></i>New Application
                        </button>
                    </div>
                </div>

                <!-- CRM -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-users text-blue-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">CRM System</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Patient and owner relationship management</p>
                    <div class="space-y-2">
                        <button onclick="testAPI('/api/crm/patients', 'GET')" class="w-full text-left px-3 py-2 bg-blue-50 rounded hover:bg-blue-100">
                            <i class="fas fa-user-injured mr-2"></i>Patients
                        </button>
                        <button onclick="testAPI('/api/crm/appointments', 'GET')" class="w-full text-left px-3 py-2 bg-blue-50 rounded hover:bg-blue-100">
                            <i class="fas fa-calendar mr-2"></i>Appointments
                        </button>
                    </div>
                </div>

                <!-- HMS Core -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-hospital-alt text-green-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">HMS Core</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Hospital management and operations</p>
                    <div class="space-y-2">
                        <button onclick="showPatientForm()" class="w-full text-left px-3 py-2 bg-green-50 rounded hover:bg-green-100">
                            <i class="fas fa-user-plus mr-2"></i>Register Patient
                        </button>
                        <button onclick="testAPI('/api/hms/inventory', 'GET')" class="w-full text-left px-3 py-2 bg-green-50 rounded hover:bg-green-100">
                            <i class="fas fa-boxes mr-2"></i>Inventory
                        </button>
                    </div>
                </div>

                <!-- OCC -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-tachometer-alt text-orange-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">Command Centre</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Real-time monitoring and control</p>
                    <div class="space-y-2">
                        <button onclick="testAPI('/api/occ/dashboard', 'GET')" class="w-full text-left px-3 py-2 bg-orange-50 rounded hover:bg-orange-100">
                            <i class="fas fa-chart-pie mr-2"></i>Dashboard
                        </button>
                        <button onclick="testAPI('/api/occ/alerts', 'GET')" class="w-full text-left px-3 py-2 bg-orange-50 rounded hover:bg-orange-100">
                            <i class="fas fa-bell mr-2"></i>Alerts
                        </button>
                    </div>
                </div>

                <!-- Partner Integration -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-plug text-indigo-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">Partner Integration</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Insurance, pharmacy, and telemedicine</p>
                    <div class="space-y-2">
                        <button onclick="testAPI('/api/partner/insurance/providers', 'GET')" class="w-full text-left px-3 py-2 bg-indigo-50 rounded hover:bg-indigo-100">
                            <i class="fas fa-shield-alt mr-2"></i>Insurance
                        </button>
                        <button onclick="showInsuranceClaimForm()" class="w-full text-left px-3 py-2 bg-indigo-50 rounded hover:bg-indigo-100">
                            <i class="fas fa-file-invoice mr-2"></i>New Claim
                        </button>
                    </div>
                </div>

                <!-- Analytics -->
                <div class="module-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-brain text-pink-600 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold">Analytics & AI</h3>
                    </div>
                    <p class="text-gray-600 mb-4">Predictive analytics and ML models</p>
                    <div class="space-y-2">
                        <button onclick="testAPI('/api/analytics/metrics', 'GET')" class="w-full text-left px-3 py-2 bg-pink-50 rounded hover:bg-pink-100">
                            <i class="fas fa-chart-line mr-2"></i>Metrics
                        </button>
                        <button onclick="testPrediction()" class="w-full text-left px-3 py-2 bg-pink-50 rounded hover:bg-pink-100">
                            <i class="fas fa-robot mr-2"></i>Predictions
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- API Response Display -->
        <div id="responseDisplay" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <h3 class="text-lg font-semibold mb-3">API Response</h3>
            <pre id="responseContent" class="bg-gray-100 p-4 rounded overflow-x-auto text-sm"></pre>
            <button onclick="closeResponse()" class="mt-4 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                Close
            </button>
        </div>

        <!-- Forms Container -->
        <div id="formsContainer"></div>
    </main>

    <!-- Footer -->
    <footer class="gradient-bg text-white mt-12 py-6">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 GrandPro HMSO. All rights reserved.</p>
            <p class="text-sm mt-2 opacity-90">Version 1.0.0 | Powered by Node.js & PostgreSQL</p>
        </div>
    </footer>

    <script>
        const API_BASE = 'http://localhost:3000';

        async function testAPI(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };
                
                if (data) {
                    options.body = JSON.stringify(data);
                }
                
                const response = await fetch(API_BASE + endpoint, options);
                const result = await response.json();
                
                document.getElementById('responseDisplay').classList.remove('hidden');
                document.getElementById('responseContent').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                alert('API Error: ' + error.message);
            }
        }

        function closeResponse() {
            document.getElementById('responseDisplay').classList.add('hidden');
        }

        function showApplicationForm() {
            document.getElementById('formsContainer').innerHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                    <div class="bg-white rounded-lg p-6 w-full max-w-md">
                        <h3 class="text-xl font-semibold mb-4">Hospital Application</h3>
                        <form onsubmit="submitApplication(event)">
                            <input type="text" id="hospitalName" placeholder="Hospital Name" class="w-full p-2 border rounded mb-3" required>
                            <input type="text" id="ownerName" placeholder="Owner Name" class="w-full p-2 border rounded mb-3" required>
                            <input type="email" id="email" placeholder="Email" class="w-full p-2 border rounded mb-3" required>
                            <input type="tel" id="phone" placeholder="Phone" class="w-full p-2 border rounded mb-3" required>
                            <input type="text" id="address" placeholder="Address" class="w-full p-2 border rounded mb-3" required>
                            <input type="text" id="city" placeholder="City" class="w-full p-2 border rounded mb-3" required>
                            <input type="text" id="licenseNumber" placeholder="License Number" class="w-full p-2 border rounded mb-3">
                            <button type="submit" class="w-full bg-purple-600 text-white py-2 rounded hover:bg-purple-700">Submit</button>
                            <button type="button" onclick="closeForm()" class="w-full mt-2 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400">Cancel</button>
                        </form>
                    </div>
                </div>
            `;
        }

        function showPatientForm() {
            document.getElementById('formsContainer').innerHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                    <div class="bg-white rounded-lg p-6 w-full max-w-md">
                        <h3 class="text-xl font-semibold mb-4">Patient Registration</h3>
                        <form onsubmit="submitPatient(event)">
                            <input type="text" id="name" placeholder="Patient Name" class="w-full p-2 border rounded mb-3" required>
                            <input type="number" id="age" placeholder="Age" class="w-full p-2 border rounded mb-3" required>
                            <select id="gender" class="w-full p-2 border rounded mb-3" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                            <input type="tel" id="phone" placeholder="Phone" class="w-full p-2 border rounded mb-3" required>
                            <input type="email" id="email" placeholder="Email" class="w-full p-2 border rounded mb-3">
                            <input type="text" id="address" placeholder="Address" class="w-full p-2 border rounded mb-3">
                            <select id="blood_group" class="w-full p-2 border rounded mb-3">
                                <option value="">Select Blood Group</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                            <button type="submit" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Register</button>
                            <button type="button" onclick="closeForm()" class="w-full mt-2 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400">Cancel</button>
                        </form>
                    </div>
                </div>
            `;
        }

        function showInsuranceClaimForm() {
            document.getElementById('formsContainer').innerHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                    <div class="bg-white rounded-lg p-6 w-full max-w-md">
                        <h3 class="text-xl font-semibold mb-4">Insurance Claim</h3>
                        <form onsubmit="submitClaim(event)">
                            <input type="number" id="patient_id" placeholder="Patient ID" class="w-full p-2 border rounded mb-3" required>
                            <input type="text" id="provider" placeholder="Insurance Provider" class="w-full p-2 border rounded mb-3" required>
                            <input type="number" id="amount" placeholder="Claim Amount" class="w-full p-2 border rounded mb-3" required>
                            <input type="date" id="service_date" class="w-full p-2 border rounded mb-3" required>
                            <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Submit Claim</button>
                            <button type="button" onclick="closeForm()" class="w-full mt-2 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400">Cancel</button>
                        </form>
                    </div>
                </div>
            `;
        }

        async function submitApplication(event) {
            event.preventDefault();
            const data = {
                hospitalName: document.getElementById('hospitalName').value,
                ownerName: document.getElementById('ownerName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                licenseNumber: document.getElementById('licenseNumber').value
            };
            await testAPI('/api/onboarding/apply', 'POST', data);
            closeForm();
        }

        async function submitPatient(event) {
            event.preventDefault();
            const data = {
                name: document.getElementById('name').value,
                age: parseInt(document.getElementById('age').value),
                gender: document.getElementById('gender').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                blood_group: document.getElementById('blood_group').value
            };
            await testAPI('/api/hms/patients', 'POST', data);
            closeForm();
        }

        async function submitClaim(event) {
            event.preventDefault();
            const data = {
                patient_id: parseInt(document.getElementById('patient_id').value),
                provider: document.getElementById('provider').value,
                amount: parseFloat(document.getElementById('amount').value),
                service_date: document.getElementById('service_date').value
            };
            await testAPI('/api/partner/insurance/claim', 'POST', data);
            closeForm();
        }

        async function testPrediction() {
            await testAPI('/api/analytics/predict/demand', 'POST', { days: 7 });
        }

        function closeForm() {
            document.getElementById('formsContainer').innerHTML = '';
        }

        // Check system status on load
        window.addEventListener('load', async () => {
            try {
                const response = await fetch(API_BASE + '/health');
                if (response.ok) {
                    console.log('Backend is healthy');
                }
            } catch (error) {
                console.error('Backend health check failed:', error);
            }
        });
    </script>
</body>
</html>
